webpackJsonp([1],{"+RDK":function(e,t){},0:function(e,t){},"8l83":function(e,t){},"N+3/":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("7+uW"),r=s("XLwt"),n=s.n(r),o={name:"LineChart",props:["sensor"],data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},time_value:"",sensor_data:[]}},methods:{selectTime:function(){this.$http.get("http://127.0.0.1:8080/api/sensor/getSensorData",{params:{id:this.sensor.id,date:this.time_value}}).then(function(e){for(var t=e.body,s=[],i=0;i<t.length;i++)s.push([t[i].data,t[i].time]);this.sensor_data=s,this.drawLineChart()},function(e){console.log(e.status)})},drawLineChart:function(){var e=document.getElementById("my_chart");n.a.init(e,"light",{renderer:"svg"}).setOption({title:{text:""},tooltip:{},grid:{left:"5%",right:"5%",top:"10%",bottom:"10%"},dataset:{source:this.sensor_data},xAxis:{type:"time"},yAxis:{},series:[{type:"line",encode:{x:1,y:0}}]})}},mounted:function(){this.drawLineChart()},watch:{sensor:function(){this.sensor_data=[],this.time_value="",this.drawLineChart()}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"block"},[s("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},on:{change:e.selectTime},model:{value:e.time_value,callback:function(t){e.time_value=t},expression:"time_value"}})],1),e._v(" "),s("div",{style:{width:"800px",height:"300px"},attrs:{id:"my_chart"}})])},staticRenderFns:[]};var l={name:"Home",components:{LineChart:s("VU/8")(o,a,!1,function(e){s("cmMX")},"data-v-5ac786e6",null).exports},data:function(){return{title:"物联网数据管理平台",user:{id:this.$route.params.id,name:this.$route.params.name},chartTitle:"传感器数据分析图",dialogVisible1:!1,dialogVisible2:!1,dialog1Title:"添加传感器",dialog2Title:"",chartVisible:!1,newSensor:{id:"",type:"",longitude:"",latitude:""},rules:{id:[{required:!0,message:"请输入传感器ID",trigger:"blur"},{min:11,max:11,message:"请输入11位长度的传感器ID",trigger:"blur"}],type:[{required:!0,message:"请选择传感器类型",trigger:"change"}],longitude:[{required:!0,message:"请输入传感器经度信息",trigger:"blur"}],latitude:[{required:!0,message:"请输入传感器纬度信息",trigger:"blur"}]},selectedSensor:{id:"",type:"",longitude:"",latitude:""},sensor_list:[]}},methods:{addSensor:function(){this.dialogVisible1=!0},submitSensor:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$http.post("http://127.0.0.1:8080/api/sensor/addSensor",{userid:t.user.id,id:t.newSensor.id,type:t.newSensor.type,longitude:t.newSensor.longitude,latitude:t.newSensor.latitude},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.body;t.success?(alert(t.message),this.getSensorList()):alert(t.message)},function(e){console.log(e.status)}),t.dialogVisible1=!1,console.log(t.newSensor)})},resetSensor:function(e){this.$refs[e].resetFields()},sensorInfo:function(e,t){this.dialog2Title=e.type+"传感器"+t+"基本信息",this.selectedSensor=e,this.dialogVisible2=!0},submitChange:function(){this.dialogVisible2=!1,console.log(this.selectedSensor)},selectSensor:function(e,t){this.chartTitle="传感器数据分析图---"+e.type+"传感器"+t,this.selectedSensor=e,this.chartVisible=!0},handleClose:function(e){this.$confirm("确认关闭？").then(function(t){e()}).catch(function(e){})},getSensorList:function(){this.$http.get("http://127.0.0.1:8080/api/sensor/getSensorList",{params:{id:this.user.id}}).then(function(e){var t=e.body,s=[];console.log(t);for(var i=0;i<t.length;i++)s.push(t[i]);this.sensor_list=s,console.log(this.sensor_list)},function(e){console.log(e.status)})}},mounted:function(){this.getSensorList()}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",[s("el-col",{attrs:{span:4}},[s("div",{staticStyle:{"margin-top":"40px"}},[s("i",{staticClass:"el-icon-user"}),e._v("\n        "+e._s(e.user.name)+"\n      ")])]),e._v(" "),s("el-col",{attrs:{span:16}},[s("h1",[e._v(e._s(e.title))])])],1),e._v(" "),s("el-row",[s("el-col",{attrs:{span:20,offset:2}},[s("el-divider"),e._v(" "),s("div",[s("el-container",{staticStyle:{height:"500px",border:"1px solid #eee"}},[s("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[s("el-menu",{attrs:{"default-openeds":["1"]}},[s("el-submenu",{attrs:{index:"1"}},[s("template",{slot:"title"},[e._v("\n                  传感器列表\n                  "),s("i",{staticClass:"el-icon-circle-plus-outline",on:{click:e.addSensor}})]),e._v(" "),s("el-menu-item-group",e._l(e.sensor_list,function(t,i){return s("el-menu-item",{key:t.id,staticStyle:{color:"#606266"},on:{click:function(s){return e.selectSensor(t,i+1)}}},[e._v("\n                    "+e._s(t.type)+"传感器"+e._s(i+1)+"\n                    "),s("i",{staticClass:"el-icon-setting",on:{click:function(s){return e.sensorInfo(t,i+1)}}})])}),1)],2)],1)],1),e._v(" "),s("el-container",[s("el-header",[s("span",[e._v(e._s(e.chartTitle))])]),e._v(" "),s("el-main",[s("div",[s("line-chart",{directives:[{name:"show",rawName:"v-show",value:e.chartVisible,expression:"chartVisible"}],attrs:{sensor:e.selectedSensor}})],1)])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.dialog1Title,visible:e.dialogVisible1,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible1=t}}},[s("el-form",{ref:"newSensor",attrs:{model:e.newSensor,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"传感器ID",prop:"id"}},[s("el-input",{model:{value:e.newSensor.id,callback:function(t){e.$set(e.newSensor,"id",t)},expression:"newSensor.id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"传感器类型",prop:"type"}},[s("el-select",{attrs:{placeholder:"请选择传感器类型"},model:{value:e.newSensor.type,callback:function(t){e.$set(e.newSensor,"type",t)},expression:"newSensor.type"}},[s("el-option",{attrs:{label:"温度",value:"温度"}}),e._v(" "),s("el-option",{attrs:{label:"湿度",value:"湿度"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"经度",prop:"longitude"}},[s("el-input",{model:{value:e.newSensor.longitude,callback:function(t){e.$set(e.newSensor,"longitude",t)},expression:"newSensor.longitude"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"纬度",prop:"latitude"}},[s("el-input",{model:{value:e.newSensor.latitude,callback:function(t){e.$set(e.newSensor,"latitude",t)},expression:"newSensor.latitude"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitSensor("newSensor")}}},[e._v("添加")]),e._v(" "),s("el-button",{on:{click:function(t){return e.resetSensor("newSensor")}}},[e._v("重置")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.dialog2Title,visible:e.dialogVisible2,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible2=t}}},[s("el-form",{ref:"selectedSensor",attrs:{model:e.selectedSensor,"label-width":"100px",disabled:!0}},[s("el-form-item",{attrs:{label:"传感器ID"}},[s("el-input",{model:{value:e.selectedSensor.id,callback:function(t){e.$set(e.selectedSensor,"id",t)},expression:"selectedSensor.id"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"传感器类型"}},[s("el-select",{attrs:{placeholder:"请选择传感器类型"},model:{value:e.selectedSensor.type,callback:function(t){e.$set(e.selectedSensor,"type",t)},expression:"selectedSensor.type"}},[s("el-option",{attrs:{label:"温度",value:"温度"}}),e._v(" "),s("el-option",{attrs:{label:"湿度",value:"湿度"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"经度"}},[s("el-input",{model:{value:e.selectedSensor.longitude,callback:function(t){e.$set(e.selectedSensor,"longitude",t)},expression:"selectedSensor.longitude"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"纬度"}},[s("el-input",{model:{value:e.selectedSensor.latitude,callback:function(t){e.$set(e.selectedSensor,"latitude",t)},expression:"selectedSensor.latitude"}})],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible2=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.submitChange}},[e._v("确 定")])],1)],1)],1),e._v(" "),s("el-divider")],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(l,c,!1,function(e){s("8l83")},"data-v-0efea094",null).exports,d={name:"Login",data:function(){return{checked:!1,login:{username:"",password:"",remember:""},rule:{username:[{validator:function(e,t,s){""===t?s(new Error("请输入用户名")):s()},trigger:"blur"}],password:[{validator:function(e,t,s){""===t?s(new Error("请输入密码")):s()},trigger:"blur"}]}}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$http.get("http://127.0.0.1:8080/api/user/login",{params:{name:t.login.username,password:t.login.password}}).then(function(e){var t=e.body;t.success?this.$router.push({path:"/home",name:"Home",params:{name:this.login.username,id:t.userid}}):alert(t.message)},function(e){console.log(e.status)})})}}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"login"}},[s("el-main",{attrs:{id:"main"}},[s("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{xs:8,sm:9,md:8,lg:6,xl:5}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"header",attrs:{solt:"header"}},[s("span",{staticClass:"item"},[e._v("登录")])]),e._v(" "),s("div",{attrs:{id:"form"}},[s("el-form",{ref:"login",attrs:{model:e.login,"status-icon":"",rules:e.rule}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-user","auto-complete":"off"},model:{value:e.login.username,callback:function(t){e.$set(e.login,"username",t)},expression:"login.username"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{placeholder:"请输入密码","prefix-icon":"el-icon-key",type:"password","auto-complete":"off"},model:{value:e.login.password,callback:function(t){e.$set(e.login,"password",t)},expression:"login.password"}})],1),e._v(" "),s("el-form-item",[s("el-checkbox",{staticClass:"check",model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住我")])],1),e._v(" "),s("el-form-item",[s("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("login")}}},[e._v("登录")])],1)],1),e._v(" "),s("div",[s("p",[s("router-link",{staticClass:"tips",attrs:{to:"/register"}},[e._v("还没有账号？点我去注册")])],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var m=s("VU/8")(d,p,!1,function(e){s("UD3a")},"data-v-2c909be8",null).exports,f={name:"Register",data:function(){return{checked:!1,register:{username:"",password:"",repassword:""}}},methods:{submitForm:function(e){var t=this;this.register.repassword!==this.register.password?(this.$emit("submit-form",this.$message({message:"两次输入的密码不相同",type:"warning",duration:6e3})),this.$refs[e].resetFields()):this.$refs[e].validate(function(e){e&&t.$http.post("http://127.0.0.1:8080/api/user/register",{name:t.register.username,password:t.register.password},{headers:{"Content-Type":"application/json"}}).then(function(e){var t=e.body;t.success?this.$emit("submit-form",this.$message({message:t.message,type:"success",duration:6e3})):this.$emit("submit-form",this.$message({message:t.message,type:"warning",duration:6e3}))},function(e){console.log(e.status)})})},registerEnter:function(e){this.submitForm(e)}}},g={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"register"}},[s("el-main",{attrs:{id:"main"}},[s("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"center"}},[s("el-col",{attrs:{xs:8,sm:9,md:8,lg:6,xl:5}},[s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"header",attrs:{solt:"header"}},[s("span",{staticClass:"item"},[e._v("注册")])]),e._v(" "),s("div",{attrs:{id:"form"}},[s("el-form",{ref:"register",attrs:{model:e.register,"status-icon":""}},[s("el-form-item",{attrs:{prop:"username",rules:[{required:!0,message:"用户名不能为空"}]}},[s("el-input",{attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-user","auto-complete":"off"},model:{value:e.register.username,callback:function(t){e.$set(e.register,"username",t)},expression:"register.username"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"password",rules:[{required:!0,message:"密码不能为空"}]}},[s("el-input",{attrs:{placeholder:"请输入密码","prefix-icon":"el-icon-key",type:"password","auto-complete":"off"},model:{value:e.register.password,callback:function(t){e.$set(e.register,"password",t)},expression:"register.password"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"repassword",rules:[{required:!0,message:"请再次输入密码"}]}},[s("el-input",{attrs:{placeholder:"请再次输入密码","prefix-icon":"el-icon-key",type:"password","auto-complete":"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.registerEnter("register")}},model:{value:e.register.repassword,callback:function(t){e.$set(e.register,"repassword",t)},expression:"register.repassword"}})],1),e._v(" "),s("el-form-item",[s("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("register")}}},[e._v("注册")])],1)],1),e._v(" "),s("div",[s("p",[s("router-link",{staticClass:"tips",attrs:{to:"/login"}},[e._v("已经有账号？点我去登录")])],1)])],1)])],1)],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(f,g,!1,function(e){s("+RDK")},"data-v-747d715a",null).exports,v={name:"App",components:{Home:u,Login:m,Register:h}},b={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var _=s("VU/8")(v,b,!1,function(e){s("N+3/")},null,null).exports,w=s("/ocq");i.default.use(w.a);var y=new w.a({routes:[{path:"/",name:"Login",component:m},{path:"/login",name:"Login",component:m},{path:"/register",name:"Register",component:h},{path:"/home",name:"Home",component:u}]}),S=s("8+8L"),k=s("zL8q"),x=s.n(k);s("tvR6");i.default.use(x.a),i.default.use(S.a),i.default.config.productionTip=!1,new i.default({el:"#app",router:y,components:{App:_},template:"<App/>"})},UD3a:function(e,t){},cmMX:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2233a40af9844b1603f5.js.map